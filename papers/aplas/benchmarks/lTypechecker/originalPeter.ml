open GT
open OCanren
open OCanren.Std
open Helper

let topLevel x0 = let rec typecheck_ gamma term q0 = ((fresh (q1) (((term === iConst_ q1) &&& (q0 === (Option.some (integer ())))))) ||| ((fresh (q3) (((term === bConst_ q3) &&& (q0 === (Option.some (boolean ())))))) ||| ((fresh (v) (((term === var_ v) &&& (nthOpt gamma v q0)))) ||| ((fresh (q6 y x) (((term === plus_ x y) &&& ((typecheck_ gamma x q6) &&& (((q6 === (Option.none ())) &&& (q0 === (Option.none ()))) ||| (fresh (q9 x') (((q6 === (Option.some (x'))) &&& ((typecheck_ gamma y q9) &&& (((q9 === (Option.none ())) &&& (q0 === (Option.none ()))) ||| (fresh (q16 q15 q12 y') (((q9 === (Option.some (y'))) &&& ((typeEq x' (integer ()) q15) &&& ((typeEq y' (integer ()) q16) &&& ((((q15 === !!false) &&& (q12 === !!false)) ||| ((q15 === !!true) &&& (q12 === q16))) &&& (((q12 === !!true) &&& (q0 === (Option.some (integer ())))) ||| ((q12 === !!false) &&& (q0 === (Option.none ())))))))))))))))))))) ||| ((fresh (q22 y x) (((term === mult_ x y) &&& ((typecheck_ gamma x q22) &&& (((q22 === (Option.none ())) &&& (q0 === (Option.none ()))) ||| (fresh (q25 x') (((q22 === (Option.some (x'))) &&& ((typecheck_ gamma y q25) &&& (((q25 === (Option.none ())) &&& (q0 === (Option.none ()))) ||| (fresh (q32 q31 q28 y') (((q25 === (Option.some (y'))) &&& ((typeEq x' (integer ()) q31) &&& ((typeEq y' (integer ()) q32) &&& ((((q31 === !!false) &&& (q28 === !!false)) ||| ((q31 === !!true) &&& (q28 === q32))) &&& (((q28 === !!true) &&& (q0 === (Option.some (integer ())))) ||| ((q28 === !!false) &&& (q0 === (Option.none ())))))))))))))))))))) ||| ((fresh (q38 y x) (((term === equal_ x y) &&& ((typecheck_ gamma x q38) &&& (((q38 === (Option.none ())) &&& (q0 === (Option.none ()))) ||| (fresh (q41 x') (((q38 === (Option.some (x'))) &&& ((typecheck_ gamma y q41) &&& (((q41 === (Option.none ())) &&& (q0 === (Option.none ()))) ||| (fresh (q44 y') (((q41 === (Option.some (y'))) &&& ((typeEq x' y' q44) &&& (((q44 === !!true) &&& (q0 === (Option.some (boolean ())))) ||| ((q44 === !!false) &&& (q0 === (Option.none ())))))))))))))))))) ||| ((fresh (q48 y x) (((term === less_ x y) &&& ((typecheck_ gamma x q48) &&& (((q48 === (Option.none ())) &&& (q0 === (Option.none ()))) ||| (fresh (q51 x') (((q48 === (Option.some (x'))) &&& ((typecheck_ gamma y q51) &&& (((q51 === (Option.none ())) &&& (q0 === (Option.none ()))) ||| (fresh (q58 q57 q54 y') (((q51 === (Option.some (y'))) &&& ((typeEq x' (integer ()) q57) &&& ((typeEq y' (integer ()) q58) &&& ((((q57 === !!false) &&& (q54 === !!false)) ||| ((q57 === !!true) &&& (q54 === q58))) &&& (((q54 === !!true) &&& (q0 === (Option.some (boolean ())))) ||| ((q54 === !!false) &&& (q0 === (Option.none ())))))))))))))))))))) ||| ((fresh (q64 e t c) (((term === if_ c t e) &&& ((typecheck_ gamma c q64) &&& (((q64 === (Option.none ())) &&& (q0 === (Option.none ()))) ||| (fresh (q67 c') (((q64 === (Option.some (c'))) &&& ((typeEq c' (boolean ()) q67) &&& ((fresh (q69) (((q67 === !!true) &&& ((typecheck_ gamma t q69) &&& (((q69 === (Option.none ())) &&& (q0 === (Option.none ()))) ||| (fresh (q72 t') (((q69 === (Option.some (t'))) &&& ((typecheck_ gamma e q72) &&& (((q72 === (Option.none ())) &&& (q0 === (Option.none ()))) ||| (fresh (q75 e') (((q72 === (Option.some (e'))) &&& ((typeEq t' e' q75) &&& (((q75 === !!true) &&& (q0 === (Option.some (t')))) ||| ((q75 === !!false) &&& (q0 === (Option.none ())))))))))))))))))) ||| ((q67 === !!false) &&& (q0 === (Option.none ()))))))))))))) ||| (fresh (q80 b v) (((term === let_ v b) &&& ((typecheck_ gamma v q80) &&& (((q80 === (Option.none ())) &&& (q0 === (Option.none ()))) ||| (fresh (v') (((q80 === (Option.some (v'))) &&& (typecheck_ ((Std.(%) (v') (gamma))) b q0))))))))))))))))) and nthOpt xs n r = (fresh (x t h) ((((xs === (Std.List.nil ())) &&& (r === (Option.none ()))) ||| ((xs === (Std.(%) (h) (t))) &&& (((n === Std.Nat.zero) &&& (r === (Option.some (h)))) ||| ((n === (Std.Nat.succ (x))) &&& (nthOpt t n r))))))) and typeEq x y q86 = (fresh (q87) (((q87 === (Pair.pair (x) (y))) &&& (((q87 === (Pair.pair (integer ()) (integer ()))) &&& (q86 === !!true)) ||| (((q87 === (Pair.pair (boolean ()) (boolean ()))) &&& (q86 === !!true)) ||| (((q87 === (Pair.pair (integer ()) (boolean ()))) &&& (q86 === !!false)) ||| ((q87 === (Pair.pair (boolean ()) (integer ()))) &&& (q86 === !!false)))))))) in    (fresh (t) ((typecheck_ ((Std.List.nil ())) t ((Option.some (integer ()))))))
