open GT
open OCanren
open OCanren.Std
open Helper

let topLevel x0 x1 = let rec assoco y2 y3 = (fresh (q1 q2 q3) (((y2 === (Std.(%) (Pair.pair (y3) (integer ())) q1)) ||| ((y2 === (Std.(%) (Pair.pair (q2) (q3)) q1)) &&& (assoco q1 y3))))) and _type y4 y5 = (fresh (q1 q2 q3 q4 q5 q6 q7 q8 q9 q10 q11 q12 q13 q14) (((((((y4 === iConst q1) ||| ((y4 === var_ q2) &&& ((y5 === (Std.(%) (Pair.pair (q2) (integer ())) q3)) ||| ((y5 === (Std.(%) (Pair.pair (q4) (q5)) q3)) &&& (assoco q3 q2))))) ||| ((y4 === plus q6 q7) &&& (typeType y5 q6 q7))) ||| ((y4 === mult q6 q7) &&& (typeType y5 q6 q7))) ||| ((y4 === let_ q8 q9 q10) &&& ((__type y5 q9 q11) &&& (__type ((Std.(%) (Pair.pair (q8) (q11)) y5)) q10 (integer ()))))) ||| ((y4 === if_ q12 q13 q14) &&& (((___type y5 q12) &&& (_type q13 y5)) &&& (_type q14 y5)))))) and typeType y6 y7 y8 = ((_type y7 y6) &&& (_type y8 y6)) and __type y9 y10 y11 = (fresh (q1 q2 q3 q4 q5 q6 q7 q8 q9 q10 q11 q12 q13 q14 q15 q16 q17) (((((((((((y10 === bConst q1) &&& (y11 === boolean ())) ||| ((y10 === iConst q2) &&& (y11 === integer ()))) ||| ((y10 === var_ q3) &&& ((y9 === (Std.(%) (Pair.pair (q3) (y11)) q4)) ||| ((y9 === (Std.(%) (Pair.pair (q5) (q6)) q4)) &&& (_assoco q4 y11 q3))))) ||| (((y10 === plus q7 q8) &&& (y11 === integer ())) &&& (typeType y9 q7 q8))) ||| (((y10 === mult q7 q8) &&& (y11 === integer ())) &&& (typeType y9 q7 q8))) ||| (((y10 === eq q9 q10) &&& (y11 === boolean ())) &&& (_typeType y9 q9 q10))) ||| (((y10 === lt q9 q10) &&& (y11 === boolean ())) &&& (_typeType y9 q9 q10))) ||| ((y10 === let_ q11 q12 q13) &&& ((__type y9 q12 q14) &&& (__type ((Std.(%) (Pair.pair (q11) (q14)) y9)) q13 y11)))) ||| ((y10 === if_ q15 q16 q17) &&& (((___type y9 q15) &&& (__type y9 q16 y11)) &&& (__type y9 q17 y11)))))) and _assoco y12 y13 y14 = (fresh (q1 q2 q3) (((y12 === (Std.(%) (Pair.pair (y14) (y13)) q1)) ||| ((y12 === (Std.(%) (Pair.pair (q2) (q3)) q1)) &&& (_assoco q1 y13 y14))))) and _typeType y15 y16 y17 = (fresh (q1) (((__type y15 y16 q1) &&& (__type y15 y17 q1)))) and ___type y19 y20 = (fresh (q1 q2 q3 q4 q5 q6 q7 q8 q9 q10 q11 q12 q13 q14) (((((((y20 === bConst q1) ||| ((y20 === var_ q2) &&& ((y19 === (Std.(%) (Pair.pair (q2) (boolean ())) q3)) ||| ((y19 === (Std.(%) (Pair.pair (q4) (q5)) q3)) &&& (__assoco q3 q2))))) ||| ((y20 === eq q6 q7) &&& (_typeType y19 q6 q7))) ||| ((y20 === lt q6 q7) &&& (_typeType y19 q6 q7))) ||| ((y20 === let_ q8 q9 q10) &&& ((__type y19 q9 q11) &&& (___type ((Std.(%) (Pair.pair (q8) (q11)) y19)) q10)))) ||| ((y20 === if_ q12 q13 q14) &&& (((___type y19 q12) &&& (___type y19 q13)) &&& (___type y19 q14)))))) and __assoco y21 y22 = (fresh (q1 q2 q3) (((y21 === (Std.(%) (Pair.pair (y22) (boolean ())) q1)) ||| ((y21 === (Std.(%) (Pair.pair (q2) (q3)) q1)) &&& (__assoco q1 y22))))) in         (_type x0 x1)
