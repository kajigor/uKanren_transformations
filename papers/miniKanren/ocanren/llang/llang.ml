open GT
open OCanren
open OCanren.Std
open Helper

let topLevel x0 x1 = let rec idx y2 y3 = (fresh (q1 q2 q3) ((((y3 === Std.Nat.zero) &&& (y2 === (Std.(%) (integer ()) q1))) ||| (((y3 === (Std.Nat.succ (q2))) &&& (y2 === (Std.(%) q3 q1))) &&& (idx q1 q2))))) and _type_ y4 y5 = (fresh (q1 q2 q3 q4 q5 q6 q7 q8 q9 q10 q11 q12 q13) (((((((y4 === iConst_ q1) ||| ((y4 === var_ q2) &&& (((q2 === Std.Nat.zero) &&& (y5 === (Std.(%) (integer ()) q3))) ||| (((q2 === (Std.Nat.succ (q4))) &&& (y5 === (Std.(%) q5 q3))) &&& (idx q3 q4))))) ||| ((y4 === plus_ q6 q7) &&& (type_Type_ y5 q6 q7))) ||| ((y4 === mult_ q6 q7) &&& (type_Type_ y5 q6 q7))) ||| ((y4 === let_ q8 q9) &&& ((__type_ y5 q8 q10) &&& (__type_ ((Std.(%) q10 y5)) q9 (integer ()))))) ||| ((y4 === if_ q11 q12 q13) &&& (((___type_ y5 q11) &&& (_type_ q12 y5)) &&& (_type_ q13 y5)))))) and type_Type_ y6 y7 y8 = ((_type_ y7 y6) &&& (_type_ y8 y6)) and __type_ y9 y10 y11 = (fresh (q1 q2 q3 q4 q5 q6 q7 q8 q9 q10 q11 q12 q13 q14 q15 q16 q17) (((((((((((y10 === bConst_ q1) &&& (y11 === boolean ())) ||| ((y10 === iConst_ q2) &&& (y11 === integer ()))) ||| ((y10 === var_ q3) &&& (((q3 === Std.Nat.zero) &&& (y9 === (Std.(%) y11 q4))) ||| (((q3 === (Std.Nat.succ (q5))) &&& (y9 === (Std.(%) q6 q4))) &&& (_idx q4 y11 q5))))) ||| (((y10 === plus_ q7 q8) &&& (y11 === integer ())) &&& (type_Type_ y9 q7 q8))) ||| (((y10 === mult_ q7 q8) &&& (y11 === integer ())) &&& (type_Type_ y9 q7 q8))) ||| (((y10 === equal_ q9 q10) &&& (y11 === boolean ())) &&& ((__type_ y9 q9 q11) &&& (__type_ y9 q10 q11)))) ||| (((y10 === less_ q9 q10) &&& (y11 === boolean ())) &&& (type_Type_ y9 q9 q10))) ||| ((y10 === let_ q12 q13) &&& ((__type_ y9 q12 q14) &&& (__type_ ((Std.(%) q14 y9)) q13 y11)))) ||| ((y10 === if_ q15 q16 q17) &&& (((___type_ y9 q15) &&& (__type_ y9 q16 y11)) &&& (__type_ y9 q17 y11)))))) and _idx y12 y13 y14 = (fresh (q1 q2 q3) ((((y14 === Std.Nat.zero) &&& (y12 === (Std.(%) y13 q1))) ||| (((y14 === (Std.Nat.succ (q2))) &&& (y12 === (Std.(%) q3 q1))) &&& (_idx q1 y13 q2))))) and ___type_ y15 y16 = (fresh (q1 q2 q3 q4 q5 q6 q7 q8 q9 q10 q11 q12 q13) (((((((y16 === bConst_ q1) ||| ((y16 === var_ q2) &&& (((q2 === Std.Nat.zero) &&& (y15 === (Std.(%) (boolean ()) q3))) ||| (((q2 === (Std.Nat.succ (q4))) &&& (y15 === (Std.(%) q5 q3))) &&& (__idx q3 q4))))) ||| ((y16 === equal_ q6 q7) &&& (_type_Type_ y15 q6 q7))) ||| ((y16 === less_ q6 q7) &&& (type_Type_ y15 q6 q7))) ||| ((y16 === let_ q8 q9) &&& ((__type_ y15 q8 q10) &&& (___type_ ((Std.(%) q10 y15)) q9)))) ||| ((y16 === if_ q11 q12 q13) &&& (((___type_ y15 q11) &&& (___type_ y15 q12)) &&& (___type_ y15 q13)))))) and __idx y17 y18 = (fresh (q1 q2 q3) ((((y18 === Std.Nat.zero) &&& (y17 === (Std.(%) (boolean ()) q1))) ||| (((y18 === (Std.Nat.succ (q2))) &&& (y17 === (Std.(%) q3 q1))) &&& (__idx q1 q2))))) and _type_Type_ y19 y20 y21 = (fresh (q1) (((__type_ y19 y20 q1) &&& (__type_ y19 y21 q1)))) in         (_type_ x0 x1)
