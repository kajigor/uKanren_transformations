open GT
open OCanren
open OCanren.Std
open Helper

let topLevel x0 = let rec type_ y0 = (fresh (q1 q2 q3 q4 q5 q6 q7 q8 q9) ((((((y0 === iConst_ q1) ||| ((y0 === plus_ q2 q3) &&& (_type_Type_ ((Std.List.nil ())) (integer ()) q3 q2 (integer ())))) ||| ((y0 === mult_ q2 q3) &&& (_type_Type_ ((Std.List.nil ())) (integer ()) q3 q2 (integer ())))) ||| ((y0 === let_ q4 q5) &&& ((__type_ ((Std.List.nil ())) q4 q6) &&& (__type_ ((Std.(%) q6 (Std.List.nil ()))) q5 (integer ()))))) ||| ((y0 === if_ q7 q8 q9) &&& ((_type_Type_ ((Std.List.nil ())) (integer ()) q8 q7 (boolean ())) &&& (__type_ ((Std.List.nil ())) q9 (integer ()))))))) and __type_ y5 y6 y7 = (fresh (q1 q2 q3 q4 q5 q6 q7 q8 q9 q10 q11 q12 q13 q14) (((((((((((y6 === bConst_ q1) &&& (y7 === boolean ())) ||| ((y6 === iConst_ q2) &&& (y7 === integer ()))) ||| ((y6 === var_ q3) &&& (_idx y5 y7 q3))) ||| (((y6 === plus_ q4 q5) &&& (y7 === integer ())) &&& (_type_Type_ y5 (integer ()) q5 q4 (integer ())))) ||| (((y6 === mult_ q4 q5) &&& (y7 === integer ())) &&& (_type_Type_ y5 (integer ()) q5 q4 (integer ())))) ||| (((y6 === equal_ q6 q7) &&& (y7 === boolean ())) &&& (_type_Type_ y5 q8 q7 q6 q8))) ||| (((y6 === less_ q6 q7) &&& (y7 === boolean ())) &&& (_type_Type_ y5 (integer ()) q7 q6 (integer ())))) ||| ((y6 === let_ q9 q10) &&& ((__type_ y5 q9 q11) &&& (__type_ ((Std.(%) q11 y5)) q10 y7)))) ||| ((y6 === if_ q12 q13 q14) &&& ((_type_Type_ y5 y7 q13 q12 (boolean ())) &&& (__type_ y5 q14 y7)))))) and _idx y8 y9 y10 = (fresh (q1 q2 q3) ((((y10 === Std.Nat.zero) &&& (y8 === (Std.(%) y9 q1))) ||| (((y10 === (Std.Nat.succ (q2))) &&& (y8 === (Std.(%) q3 q1))) &&& (_idx q1 y9 q2))))) and _type_Type_ y15 y16 y17 y18 y19 = (fresh (q1 q2 q3 q4 q5 q6 q7 q8 q9 q10 q11 q12 q13 q14) ((((((((((((y18 === bConst_ q1) &&& (y19 === boolean ())) &&& (__type_ y15 y17 y16)) ||| (((y18 === iConst_ q2) &&& (y19 === integer ())) &&& (__type_ y15 y17 y16))) ||| ((y18 === var_ q3) &&& ((_idx y15 y19 q3) &&& (__type_ y15 y17 y16)))) ||| (((y18 === plus_ q4 q5) &&& (y19 === integer ())) &&& ((_type_Type_ y15 (integer ()) q5 q4 (integer ())) &&& (__type_ y15 y17 y16)))) ||| (((y18 === mult_ q4 q5) &&& (y19 === integer ())) &&& ((_type_Type_ y15 (integer ()) q5 q4 (integer ())) &&& (__type_ y15 y17 y16)))) ||| (((y18 === equal_ q6 q7) &&& (y19 === boolean ())) &&& ((_type_Type_ y15 q8 q7 q6 q8) &&& (__type_ y15 y17 y16)))) ||| (((y18 === less_ q6 q7) &&& (y19 === boolean ())) &&& ((_type_Type_ y15 (integer ()) q7 q6 (integer ())) &&& (__type_ y15 y17 y16)))) ||| ((y18 === let_ q9 q10) &&& ((_type_Type_ y15 y16 y17 q9 q11) &&& (__type_ ((Std.(%) q11 y15)) q10 y19)))) ||| ((y18 === if_ q12 q13 q14) &&& ((_type_Type_ y15 y19 q13 q12 (boolean ())) &&& (_type_Type_ y15 y16 y17 q14 y19)))))) in     (type_ x0)
