

\begin{tikzpicture}[
  decoration = {
    snake,
    pre length=2pt,
    post length=4pt,
    amplitude=0.5pt,
    segment length=4pt,
  },
  remember picture,overlay]
  % \draw[thick] (current page.south west) rectangle (current page.north east);
  \node (a) [
    program,
    anchor=north west,
    xshift=0.4cm,
    yshift=-1.4cm]
    at (current page.north west)
  {
    \adjustbox{scale=0.5}{
      \begin{minipage}[c]{0.4\textwidth}
        \input{appendoDef.tex}
      \end{minipage}
    }
  };

  \node (b) [goal,anchor=north east] at (a.south east)
  {
    \adjustbox{scale=0.5}{
      \begin{minipage}[c]{0.22\textwidth}
        \begin{lstlisting}
append$^o$ x y r
        \end{lstlisting}
      \end{minipage}
    }
  };

  \pause

  \node (d) [
    transparent,
    anchor=north east,
    xshift=-0.4cm,
    yshift=-1.4cm]
    at (current page.north east)
  {
    \input{unfold.tex}
  };

  \node (exmpl) [
    draw=black,
    rectangle,
    semithick,
    rounded corners=2pt,
    align=center,
    anchor=south east,
    xshift=-0.4cm,
    yshift=0.7cm,
    scale=0.6]
    at (current page.south east)
    {
      \rel{append}{$x' \ y \ r'$ \\ \subst{$x \to h :: x', r \to h :: r'$}}
    };

  \node (tip1) [transparent,anchor=south east] at ($(exmpl.south west)-(0.5,0)$)
  { \scriptsize
    goal
  };

  \node (tip2) [transparent,anchor=south east] at ($(exmpl.north east)+(0,0.5)$)
  { \scriptsize
    substitution
  };

  \draw[densely dotted,->]
    (tip1.north east) to
    [out=45,in=180]
    ($(exmpl.north west)+(0.45,-0.2)$);

  \draw[densely dotted,->]
    (tip2.south east) to
    [out=-30,in=0]
    ($(exmpl.east)+(0,-0.15)$);


  \pause

  \node (c) [
    transparent,
    anchor=south west,
    xshift=0.4cm,
    yshift=0.7cm]
    at (current page.south west)
  {
    \input{appendoCPD.tex}
  };

    \onslide<1->
\end{tikzpicture}